<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>GitHub Chat Fix</title>
    <style>
        body { font-family: sans-serif; max-width: 500px; margin: 20px auto; }
        #messages { height: 300px; overflow-y: auto; border: 1px solid #ccc; padding: 10px; margin-bottom: 10px; }
        .msg { margin-bottom: 8px; border-bottom: 1px solid #eee; }
    </style>
</head>
<body>
    <div id="messages"></div>
    <input type="text" id="nameInput" placeholder="Имя" style="width: 20%;">
    <input type="text" id="messageInput" placeholder="Сообщение..." style="width: 60%;">
    <button id="sendBtn">ОК</button>

    <!-- Подключаем старым надежным способом через глобальные переменные -->
    <script src="https://www.gstatic.com"></script>
    <script src="https://www.gstatic.com"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBQ8AVQ1D8c0IpDgoRXL0QayaaVktd3_Xg",
            databaseURL: "https://gitchat-2b675-default-rtdb.firebaseio.com",
            projectId: "gitchat-2b675",
            appId: "1:1021059658961:web:e455940894ca49673481f0"
        };

        // Инициализация (v8 стиль)
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const chatRef = db.ref("messages");

        // Чтение
        chatRef.on("child_added", (snapshot) => {
            const data = snapshot.val();
            const div = document.createElement("div");
            div.className = "msg";
            div.innerHTML = `<b>${data.name}:</b> ${data.text}`;
            document.getElementById("messages").appendChild(div);
            document.getElementById("messages").scrollTop = 9999;
        });

        // Отправка
        document.getElementById("sendBtn").onclick = function() {
            const name = document.getElementById("nameInput").value || "Аноним";
            const text = document.getElementById("messageInput").value;
            if (text) {
                chatRef.push({ name: name, text: text, time: Date.now() });
                document.getElementById("messageInput").value = "";
            }
        };
    </script>
</body>
</html>
