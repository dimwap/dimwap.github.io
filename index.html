<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>GitHub Realtime Chat</title>
    <style>
        body { font-family: sans-serif; max-width: 500px; margin: 20px auto; }
        #messages { height: 300px; overflow-y: auto; border: 1px solid #ccc; padding: 10px; margin-bottom: 10px; background: #f9f9f9; }
        .msg { margin-bottom: 10px; padding: 5px; border-bottom: 1px solid #eee; }
        input { padding: 8px; margin-right: 5px; }
    </style>
</head>
<body>

    <h2>Чат (Firebase + GitHub)</h2>
    <div id="messages"></div>
    
    <input type="text" id="nameInput" placeholder="Ваше имя" style="width: 80px;">
    <input type="text" id="messageInput" placeholder="Сообщение..." style="width: 250px;">
    <button id="sendBtn">Отправить</button>

    <script type="module">
        // Импортируем нужные функции из SDK v12
        import { initializeApp } from "https://www.gstatic.com";
        import { getDatabase, ref, push, onChildAdded } from "https://www.gstatic.com";

        // Ваши конфиги
        const firebaseConfig = {
            apiKey: "AIzaSyBQ8AVQ1D8c0IpDgoRXL0QayaaVktd3_Xg",
            authDomain: "gitchat-2b675.firebaseapp.com",
            databaseURL: "https://gitchat-2b675-default-rtdb.firebaseio.com",
            projectId: "gitchat-2b675",
            appId: "1:1021059658961:web:e455940894ca49673481f0"
        };

        // Инициализация
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const chatRef = ref(db, "messages");

        const msgContainer = document.getElementById("messages");
        const nameInp = document.getElementById("nameInput");
        const msgInp = document.getElementById("messageInput");
        const btn = document.getElementById("sendBtn");

        // Слушаем базу на новые сообщения
        onChildAdded(chatRef, (snapshot) => {
            const data = snapshot.val();
            const div = document.createElement("div");
            div.className = "msg";
            div.innerHTML = `<b>${data.name}</b>: ${data.text}`;
            msgContainer.appendChild(div);
            msgContainer.scrollTop = msgContainer.scrollHeight;
        });

        // Отправка сообщения
        btn.onclick = () => {
            if (msgInp.value.trim() !== "") {
                push(chatRef, {
                    name: nameInp.value || "Аноним",
                    text: msgInp.value,
                    timestamp: Date.now()
                });
                msgInp.value = "";
            }
        };
    </script>
</body>
</html>
